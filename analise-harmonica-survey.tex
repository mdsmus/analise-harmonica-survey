\documentclass{article}
\usepackage{icmc,amsmath}
\usepackage{graphicx}
\usepackage[T1]{fontenc}
\usepackage{url}
\usepackage{pifont}

\newcommand{\nota}[1]{
  \vspace{.5cm}
  \framebox{\ding{112} \textbf{nota:} \textit{#1}}
  \vspace{.5cm}
}

\hyphenation{nea-po-li-tan}

\title{A Survey of Automated Harmony Analysis Techniques}
 
\oneauthor
  {Pedro Kröger, Alexandre Passos, Marcos Sampaio}
  {Genos---Computer Music Research Group\\ School of Music
   \\ Federal University of Bahia, Brazil \\
  \url{pedro.kroger@gmail.com}, \url{alexandre.tp@gmail.com}, \url{mds_ufba@yahoo.com.br}}

\begin{document}

\maketitle

%% artigo deve ter 4 ou 8 paginas

\begin{abstract}
Since Winograd in 1968, the problem of using the computer to do
automated harmonic analysis has been approached, from several different
directions, most with reasonable success. On the other hand, little
has been done towards stabilishing standard benchmarks, and
identifying and solving the remaining issues of harmonic-significant
segmentation of musical pieces and properly using contextual
information.

Here we present a comprehensive survey of the existing literature on
the subject, as a means to enable more focused research on the area.
\end{abstract}

\section{Introduction}
\label{sec:introduction}

Music information retrieval has received increasing attention
recently. Some research focus on music retrieval by query-by-humming
\cite{hu02comparison,pickens02:polyphonic}, development of tools for
digital libraries
\cite{clausen00:proms,olson03:chopin,fujinaga02:digital}, detection of
musical patterns
\cite{lartillot-nakamura03:discovering,dannenberg02:pattern,lartillot02:integrating}
that may help, among other things, in identifying musical styles
\cite{dixon03:classification,pampalk03:exploring,rauber02:using}, and
in problems related to musical representation
\cite{lee02:representing,good00:representing,rol00:xml4mir}.

While the main goal in music information retrieval `` is not an
understanding of music. It is not to develop a better theory of music,
or even to analyze music. The goal is retrieval''
\cite{pickens01:survey}, other researchers seek a better understanding
of elements and musical processes through automatic analysis by
computer. We agree with Mouton that ``only automatic analysis of a
large corpus of tonal music may eventually provide us (the human) with
insights on the very nature of tonal music'' \cite{mouton95:numeric}.
Computer-based musical analysis is important because it can bring new
insights in musical theory, in the same way as use of computer in vision
and problem solving has brought new insights in these areas
\cite{temperley99:modeling}.

There are many practical applications for automatic music analysis,
among them arranging, detection of possible logical mistakes in scores,
database search, automatic accompaniment generation, and statistical
analysis of musical styles for automated composition
\cite{pardo02:algorithms,temperley99:modeling}.

Functional harmonic analysis is a specific kind of musical analysis,
in which a musical passage is represented as a sequence of chords. By
definition, automated harmony analysis must be done completely by
computer programs without human intervention. Typically the system
accepts musical data in a format such as MIDI or scores in symbolic or
numeric format, and returns information such as chord roots, chord
types, or symbols in roman numerals indicating tonal function.

This paper gives an overview of the current status of automated
harmonic analysis. To our knowledge, there is no comprehensive survey
on this subject. Scholz \cite{scholz05:funchal} offers a brief survey
of the state of the art until 2001. Mouton \cite{mouton95:numeric} and
Barthèlemy \cite{barthelemy01:figured} have a general but informative
survey on the topic.

\nota{falar como serão feitas as coisas nesse artigo}

This paper will begin by pointing out the main problems and existent
solutions in the field, and then proceed in discussing their
effectiveness.

\section{The problem of automated harmonic analysis}
\label{sec:problem}

The problem of automated harmonic analysis might be understood by
dividing it into three sub-problems. The first problem is to divide a
given piece in segments with harmonic significance. The second is to
label each segment with a chord name. The last problem is to assign a
tonal function to each chord.

A few additional sub-problems might arise from the input format, such as
determining meter or a correct pitch spelling depending on its
suitability.

\section{Music representation and ...}
\label{sec:representation}

A musical piece must be represented in a form suitable to automated
analysis before making any attempt to extract information. There is a
broad number of codifications in existence, focusing on performance,
sound synthesis, computer games, musical notation, braille notation,
folk songs, musical bibliography, and many others
\cite{selfridge-field97:beyond}.

Interestingly, the choice of a proper codification influences the
results obtainable from the later analysis. For example, chords that
sound the same but have different tonal function and spelling might
not be told apart using an algorithm that does not consider enharmonic
difference. For instance, in \cite{pardo02:algorithms} a German
augmented sixth chord is mistakenly identified as a dominant seventh
chord.

%%% tipos de representação que são usados

\nota{reescrever enfatizando as codificações}

In \cite{prather96:harmonic} notes are represented as pitch classes
only, ignoring enarmonic information. Meter, also, is widely
simplified, being reduced to a percentage of time a given pitch class
is sounding in a given measure. In \cite{buzzanca02:supervised}, meter
is represented as the logarithm of beat length, ignoring most complex
beats. \cite{barthelemy01:figured} claims to distinguish enharmonic
notes, even though the exact representation used is not discussed.
MIDI input is used in \cite{wang97:generating} and
\cite{raphael03:harmonic}. \cite{pachet96representing} describes a
codification for polyphonic tonal music, but makes no concrete claims
towards its applicability in harmonic analysis.
\cite{pardo02:algorithms}, \cite{pardo99:automated} uses a simplistic
system, representing pitches only as pitch classes, ignoring meter and
all forms of context information, with the intention of providing a
basis for sutdy of better algorithms.
\cite{tsui02:_harmon_analy_using_neural_networ} and other systems
differentiate in importance notes having different meter strength.

A few numeric representations such as \cite{hewlett92:base40} and
\cite{oliveira01:codificacao} where developed to keep the
characteristics of tonal music, being the last one is particularly
elegant. It is based on a modulo 96 where the common pitch class
notation uses modulo 12. We believe that the use of this system can
simplify the research in harmonic analysis.

%%% representação específicas para acordes (tipos de saida da analise)

\nota{colocar referencias nos tipos de saida}

The systems described in literature usually return information such as
chord roots, chord types, keys, or symbols in roman numerals
indicating tonal function.

\nota{re-escreve}

% eu seja, sua ideia é colocar no 1o paragrafo tudo que for comum e
% nao precisar de muita explicação e no 2o o que for mais especifico e
% diferente?

For instance, the system described in \cite{pachet00:computer} outputs
not only the chord names (e.g. Db7) but some functions used in jazz
harmony like ``modal borrowing'' and ``tritone substitution''. Results
from \cite{barthelemy01:figured} are in the form of figured bass, like
$7+$, $^{+6}_{\ \ \,3}$, and $^6_5$. Most systems, as those from
\cite{pardo02:algorithms,pardo00:automated,temperley99:modeling}, use
chord notation like A$\flat$7, D$\flat$min, for A flat with minor
seventh and D flat minor, respectively.

\nota{checar se algum sistema mostra numerais romanos como saida}

\cite{Ulrich77IJ} performs a functional analysis of chords, indicating
information such as ``tonic of G'', ``substitute for x+2''. But no
system seems to generate a functional analysis like ii$^6_6$, V7, and
so on.

Since the usual notation for chords is ambiguous, some alternatives
were proposed. Harte et al. notation \cite{harte.sandler.ea:symbolic}
has tuples of chord intervals, like \texttt{c:(3,5)} or
\texttt{d\#:(b3,5,b7,9)/5}. Since this notation is too verbose Harte
et al. use shorthands such as \texttt{d\#:min9/5}. Kroger et. al
\cite{kroger06:processo} use a list with chord information in the
format \texttt{(<name> <type> <intervals> <inversion>)}. For instance,
a G7/B chord could be notated as \texttt{(g major 7 1)}.

\section{Proposed Solutions}
\label{sec:proposed-solutions}

Many techniques from artificial intelligence, such as machine learning
and pattern recognition, have been used in automated harmonic
analysis. These may be subdivided in the expert-system approach,
concerned with computerized representation of harmonic rules; and the
statistical approach, that deduces said rules from probabilistic
models.

\subsection{Expert System Approaches}
\label{sec:expert-syst-appr}

Since expert systems abound in the field of artificial intelligence it
is only natural that they should be the first attempt at codifying
musical theory in a format proper for automated analysis. 

Pattern matching over chord templates is used in
\cite{prather96:harmonic}, \cite{pardo02:algorithms}, and
\cite{pardo99:automated}. Barthèlemy \cite{barthelemy01:figured} uses
a somewhat more complex model, that can ignore ornamental notes. Wang
\cite{wang97:generating} uses pattern matching in three passes and
assumes that no modulation happens. Temperley
\cite{temperley99:modeling} uses a sophisticated preference-rule
system to identify the roots of the chords in a piece, but it avoids
the problems of tonality detection and harmonic function
identification.

Barthèlemy \cite{barthelemy01:figured} and Mouton
\cite{mouton95:numeric} use a greedy algorithm for tonality
recognition that is based on the fact that every chord can be only
part of a few keys.

\subsection{Statistical Approaches}
\label{sec:stat-appr}

\nota{explicar melhor a parte do training data}

% On the other hand, they rely solely on their training data to perform
% analysis, and so are quick to misbehave when facing a score in a
% different style.

While not specifically addressing the problem of musical context,
statistical models differ from their rule-based counterparts by
considering this information implicitly. On the other hand, they are
very sensitive to the training data, tending to misbehave on slightly
different scores.

\nota{revisar e avaliar o que tem sido usado}

Back-propagating neural networks are used by T'sui
\cite{tsui02:_harmon_analy_using_neural_networ} and Buzzanca
\cite{buzzanca02:supervised} with good results. A hidden markov model
is employed by Raphael \cite{raphael03:harmonic} and Noland Sandler
\cite{noland.sandler:key}. A bayesian model is used by Temperley
\cite{temperley04:bayesian} for key recognition.

\section{Segmentation}
% passos

The division of a given piece in harmonic significant segments is a
crucial problem in the area of automated harmonic analysis, although
underrepresented in literature
\cite{pardo02:algorithms,byrd02:problems}.

The task of designing an effective algorithmical solution for the
problem of segmentation is difficult because the segmentation problem
isn't clearly formalized in the music theory literature. 

This problem is of high computational complexity, since the number of
possible partition points in a given piece is proportional to the
number of notes. The number of possible segmentations is approximately
two to the power of the number of partition points. To reduce the
space of possible partitions one must consider the harmonic context of
each segment, which is difficult. Most systems make little use of
proper context, according to Barthèlemy \cite{barthelemy01:figured}.

\nota{explicar melhor}

Prather \cite{prather96:harmonic} approaches the problem in a
simplified fashion, with chords being assumed to change only in the
beats of a given measure, and tonal information spread between two
measures being ignored.

\nota{explicar melhor} 

\cite{barthelemy01:figured} uses melodic and harmonic information to
construct the segmentation bottom-up, i.e. merging two adjacent
segments if and only every sound of the first belongs in the second
and vice versa or if the union (with or without ornamental notes) of
both segments can be exactly mapped onto a chord. The process starts
with minimal segments and ends only when no more merges can be
performed.

\cite{pardo02:algorithms} and \cite{pardo99:automated} perform
segmentation backwards, by comparing all possible (or likely, in
another version of the algorithm) segmentations, choosing the ones
that better match chord templates.

%%kroger: completar
Segmentation is also a problem in research dealing with audio formats.
\cite{abdallah.noland.ea:theory} divides the segmentation by timber,
harmony, and rhythm and pitch. ``they are not well adapted for use in
structure analysis from audio'' \cite{maddage04:content} combines
audio and symbolic representation for music structure analysis,
including chord detection.

We believe the segmentation problem for harmonic analysis of tonal
music is largely unsolved.

\section{Harmonic Context}
% marcos

As we saw, some algorithms ignore or make minimal use of the harmonic
context. It can be understood as an enviroment where each element ---
such as notes, chords and phrases --- has a kind and a level of
relation to the others. In harmony some structures like non-chord
notes are better understood if seen in a particular context. For
instance, a passing note is a non-chord note that only can be
identified if is approached and left by step in the same direction.

Thus the harmonic context is important in automated harmonic analysis
systems because proper use of harmonic context helps solving problems
such as ambiguities in chord analysis, identification of non-chord
notes, and suspension and ritardo of resolutions.

The NUSO system \cite{mouton95:numeric} uses harmonic context to
define tonality through rules considering non-chord notes in
accompanied melody, Alberti bass, and baroque style. The MusES system
<<cita>> uses relations between adjacent chords to define the best
possible tonality for a chord. Finally, the automated harmonic
analysis method developed by \cite{barthelemy01:figured} has a simple
algorithm to process non-chord notes, often producing errors. It
assumes that every non-chord note is followed by a conjunct movement,
which is not always true.

Some projects don't take harmonic context into account. Harte et al.
\cite{harte.sandler.ea:symbolic} ignores key context in their model
for chord labels. Pardo \cite{pardo99:automated,pardo02:algorithms}
developed a set of algorithms for automated chordal analysis,
purposefully making minimal use of harmonic context.

\nota{expandir sobre os problemas}

\cite{harte.sandler.ea:symbolic} says that in classical harmony
analysis the ``chords are notated in the context of a given key'', but

The error frequencies are classified and most of them are
related to harmonic context, specifically non-chord notes and cadence
recognition. The authors agree that a deeper understanding of voice
leading and knowledge about neighbour chords would help adjusting
chord-label weights.

\section{Tests and benchmarks}

Pardo states that ``no researchers have published statistical
performance results on a system designed to analyze tonal music''
\cite{pardo02:algorithms} before his paper. This lack of data in the
literature makes it dificult to compare different systems. Also, there
aren't standard benchmarks to compare different algorithms and
results. In fact, only Pardo \cite{pardo00:automated} and Barthelemy
\cite{barthelemy01:figured} published specific comparisons between
theirs and other's results. Pardo compares his results with
\cite{temperley99:modeling} while Barthelemy compares his model
against \cite{maxwell92:expert}, \cite{pardo99:automated} and
\cite{temperley96:algorithm}. However, they are based on the results
published in papers and not on results from direct implementations,
which means that only the examples published by the authors can be
compared. 

\section{Conclusion and discussion}
\label{sec:concl-disc}

We believe in the importance of having standard tests to be performed
in a large corpus of music.

We believe that a more systematic approach to music segmentation might
wield considerably better results,


Although many aspects of music can be understood using mathematical
models such as the set theory (of post-tonal theory), it is not clear
in the literature if a mathematical approach could help in the problem
of harmonic analysis. Taneyev \cite{taneyev62:counterpoint} has used
mathematics extensively in his counterpoint treatise with a good
degree of success. As far as we know, there are not meaningful works
in the literature of automatic harmonic analysis where a mathematical
model such as the set theory is used extensively.

\nota{checar para ver se é 100\% verdade}

\cite{pardo02:algorithms} uses tuples as templates, with a numerical
representation of notes. All posible transpositions are defined as
templates, when could be much easier to calculate if two pitch class
sets are the same using the prime form. Maybe things like normal and
prime form, interval vector, index vector, and operations with super
and sub-sets can help identifying harmonic elements from the non-harmonic.

\nota{ver \cite{conklin95:multiple} em detalhe}

\nota{ver se cita \cite{conklin02:representation}}

\bibliographystyle{plain}
\bibliography{analise-harmonica,bib-geral,bib-outras,analise-harmonica-nao-tenho}
\end{document}
 
http://www.aaue.dk/~niklas/ICMC/?page_id=3

\section{Terminology}
% todos

% uma lista de possíveis termos a ser definidos, depois reduzir pra só
% os relevantes e definí-los
meter
pitch
segmentation
tonality
harmony
hidden markov model
melody
neural network
expert system
pattern matching
chord
greedy algorithm
island growing
ornamental note
music/harmonic context
Forma prima.
  Uma maneira de representar a classe de
  conjunto de uma maneira compacta e não-ambígua.
Vetor intervalar.
Uma representação compactada contendo
  todos os intervalos em um conjunto.
Número de classificação de Allen Forte.
Classificação
  usando dois dígitos proposta por Allen Forte para todas as classes
  de conjuntos. O primeiro dígito indica a quantidade de notas no
  conjunto e o segundo sua posição na lista de classes de conjuntos.
