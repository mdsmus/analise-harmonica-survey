\documentclass{article}
\usepackage{icmc,amsmath}
\usepackage{graphicx}
\usepackage[T1]{fontenc}
\usepackage{url}
\usepackage{pifont}

\newcommand{\nota}[1]{
  \vspace{.5cm}
  \framebox{\ding{112} \textbf{nota:} \textit{#1}}
  \vspace{.5cm}
}

\hyphenation{nea-po-li-tan}

\title{A Survey of Automated Harmony Analysis Techniques}
 
\oneauthor
  {Pedro Kröger, Alexandre Passos, Marcos Sampaio}
  {Genos---Computer Music Research Group\\ School of Music
   \\ Federal University of Bahia, Brazil \\
  \url{pedro.kroger@gmail.com}, \url{alexandre.tp@gmail.com}, \url{mds_ufba@yahoo.com.br}}

\begin{document}

\maketitle

%% artigo deve ter 4 ou 8 paginas

\begin{abstract}
Since Winograd in 1968, the problem of using the computer to do
automated harmonic analysis has been approached, from several different
directions, most with reasonable success. On the other hand, little
has been done towards stabilishing standard benchmarks, and
identifying and solving the remaining issues of harmonic-significant
segmentation of musical pieces and properly using contextual
information.

Here we present a comprehensive survey of the existing literature on
the subject, as a means to enable more focused research on the area.
\end{abstract}

\section{Introduction}
\label{sec:introduction}

Music information retrieval has received increasing attention
recently. Some research focus on music retrieval by query-by-humming
\cite{hu02comparison,pickens02:polyphonic}, development of tools for
digital libraries
\cite{clausen00:proms,olson03:chopin,fujinaga02:digital}, detection of
musical patterns
\cite{lartillot-nakamura03:discovering,dannenberg02:pattern,lartillot02:integrating}
that may help, among other things, in identifying musical styles
\cite{dixon03:classification,pampalk03:exploring,rauber02:using}, and
in problems related to musical representation
\cite{lee02:representing,good00:representing,rol00:xml4mir}.

While the main goal in music information retrieval `` is not an
understanding of music. It is not to develop a better theory of music,
or even to analyze music. The goal is retrieval''
\cite{pickens01:survey}, other researchers seek a better understanding
of elements and musical processes through automatic analysis by
computer. We agree with Mouton that ``only automatic analysis of a
large corpus of tonal music may eventually provide us (the human) with
insights on the very nature of tonal music'' \cite{mouton95:numeric}.
Computer-based musical analysis is important because it can bring new
insights in musical theory, in the same way as use of computer in vision
and problem solving has brought new insights in these areas
\cite{temperley99:modeling}.

There are many practical applications for automatic music analysis,
among them arranging, detection of possible logical mistakes in scores,
database search, automatic accompaniment generation, and statistical
analysis of musical styles for automated composition
\cite{pardo02:algorithms,temperley99:modeling}.

Functional harmonic analysis is a specific kind of musical analysis,
in which a musical passage is represented as a sequence of chords. By
definition, automated harmony analysis must be done completely by
computer programs without human intervention. Typically the system
accepts musical data in a format such as MIDI or scores in symbolic or
numeric format, and returns information such as chord roots, chord
types, or symbols in roman numerals indicating tonal function.

This paper gives an overview of the current status of automated
harmonic analysis. To our knowledge, there is no comprehensive survey
on this subject. Scholz \cite{scholz05:funchal} offers a brief survey
of the state of the art until 2001. Mouton \cite{mouton95:numeric} and
Barthèlemy \cite{barthelemy01:figured} have a general but informative
survey on the topic.

\nota{falar como serão feitas as coisas nesse artigo}

This paper will begin by pointing out the main problems and existent
solutions in the field, and then proceed in discussing their
effectiveness.

\section{The problem of automated harmonic analysis}
\label{sec:problem}

The problem of automated harmonic analysis might be understood by
dividing it into three sub-problems. The first problem is to divide a
given piece in segments with harmonic significance. The second is to
label each segment with a chord name. The last problem is to assign a
tonal function to each chord.

A few additional sub-problems might arise from the input format, such as
determining meter or a correct pitch spelling depending on its
suitability.

\section{Representation}

Before any attempt is made to extract information from a given musical
piece, it must be codified in a form amenable to automated
analysis. Representing musical information on a computer is not a
solved problem, there being a multitude of possible codifications,
from more sound-oriented ones - such as MIDI and piano roll notation -
to notations, such as \cite{kroger06:processo}, specifically made to
better transmit harmonic information. Interestingly, the choice of a
proper codification influences the results obtainable from the later
analysis. For example, a representation which fails to distinguish
enharmonic pitches might make harder to recognize a neapolitan sixth
from an augmented seventh. Thus, it is crucial that a good input
format be chosen so as to minimize errors and necessary human input in
the analysis.

\cite{harte.sandler.ea:symbolic} suggests an unambiguous notation for
chords in a format like \texttt{c:(3,5)}, \texttt{d\#:(b3,5,b7,9)/5}.
Since this notation is too verbose, the author himself proposes a
shorthand notation like \texttt{d\#:min9/5}. \cite{kroger06:processo}
proposed a notation for chords using a list in the format
\texttt{(<name> <type> <intervals> <inversion>)}, for exemplo, a G7/B
could be notated as \texttt{(g major 7 1)}. This rationale also enables
a more verbose notation like 

\begin{verbatim}
(:fundamental g
 :added-note 7
 :inversion first
 :type diminished)
\end{verbatim}


In \cite{prather96:harmonic}, pitch height is ignored, as are
accidents, and notes are represented as pitch classes only, ignoring
extra information presente in accidents. Meter, also, is widely
simplified, being reduced to a percentage of time a given pitch class
is sounding in a given measure. In \cite{buzzanca02:supervised}, meter
is represented as the logarithm of beat length, ignoring most complex
beats. \cite{barthelemy01:figured} claims to distinguish enharmonic
notes, even though the exact representation used is not discussed.
MIDI input is used in \cite{wang97:generating} and
\cite{raphael03:harmonic}. \cite{pachet96representing} describes a
codification for polyphonic tonal music, but makes no concrete claims
towards its applicability in harmonic analysis.
\cite{pardo02:algorithms}, \cite{pardo99:automated} uses a simplistic
system, representing pitches only as pitch classes, ignoring meter and
all forms of context information, with the intention of providing a
basis for sutdy of better
algorithms. \cite{tsui02:_harmon_analy_using_neural_networ} and other
systems differentiate in importance notes having different meter
strength.


Probably the simplest harmonic output is the key of a musical
passage. Most recent research on estimation of musical keys is
concerned with the analysis of audio signals
\cite{izmirli:audio,noland.sandler:key,peeters:chroma-based}. Some
research, also, focuses on translating the results to another medium.
For instance, \cite{wang97:generating} generates a 6-line guitar
score, a tablature marked with the chords for a given passage, from
the analysis of a MIDI input. The system described in
\cite{pachet00:computer} outputs not only the chord names (e.g. Db7)
but some functions used in jazz harmony like ``modal borrowing'' and
``tritone substitution''. Results from \cite{barthelemy01:figured} are
in the form of figured bass, like $7+$, $^{+6}_{\ \ \,3}$, and
$^6_5$. Most systems, as those from
\cite{pardo02:algorithms,pardo00:automated,temperley99:modeling}, use
chord notation like A$\flat$7, D$\flat$min, for A flat with minor
seventh and D flat minor, respectively.

\cite{Ulrich77IJ} performs a functional analysis of chords, indicating
information such as ``tonic of G'', ``substitute for x+2''.
%% precisa checar
But no system seems to generate a functional analysis like ii$^6_6$,
V7, and so on.
%% duvidoso. Alguns sistemas fazem isso, se não me engano.

A few numeric representations such as \cite{hewlett92:base40} and
\cite{oliveira01:codificacao} where developed to keep the
characteristics of tonal music, being the last one is particularly
elegant. It is based on a modulo 96 where the common pitch class
notation uses modulo 12. We believe that the use of this system can
simplify the research in harmonic analysis.

The major problem of not taking in account the enharmonic differences
is that chords that sound the same but have different tonal function
may not be detected. For instance, in \cite{pardo02:algorithms} a
German augmented six chord is mistakenly identified as a dominant
seventh chord.

\section{Algorithms}


Many approaches related to the fields of artificial intelligence,
machine learning and pattern recognition have been applied to the
field of automated harmonic analysis. Roughly speaking, they may be
subdivided in two areas, one concerned with computerized
representation of harmonic rules and the other with inference of said
rules from probabilistic models. They are, respectively, the
deterministic and the probabilistic approach.

\subsection{Deterministic/Expert System Approaches}

Rule-based expert systems abound in the field of artificial
intelligence, so it is only natural that they should be the first
attempt at codifying musical theory in a format deemed proper for a
computer to make automated analysis.

Pattern-matching over chord templates is used in
\cite{prather96:harmonic}, \cite{pardo02:algorithms},
\cite{pardo99:automated} and \cite{barthelemy01:figured}, with the
latter using a somewhat more complex model, being capable of ignoring
ornamental notes. A rule-based expert system approach is used in
\cite{buzzanca01:rule}, but for music style
regognition. \cite{wang97:generating} uses three passes for chord
identification, all of them assuming a constant tonality, and
consisting basically of pattern-matching on many
levels. \cite{temperley99:modeling} uses a sophisticated
preference-rule based expert system to identify the roots of the
chords in a piece, but it avoids the problems of tonality detection
and harmonic function identification.

For tonality recognition, \cite{barthelemy01:figured} and
\cite{mouton95:numeric} use an ``island growing'' approach, a greedy
algorithm that is based on the fact that every chord can be only part
of a few tonalities and, detecting each of those for every chord,
tries to merge them when possible, detecting a tonality change when a
merge isn't possible. 

%%
%% Nota: o artigo de winograd foi muito citado. Ele deveria constar
%%       na nossa bibliografia? Posso comentar por terceiros a
%%       abordagem dele, se for o caso.

\subsection{Probabilistic Approaches}


Probabilistic and statistical models for automated harmonic analysis
are few, and far in between, but they have made promising
results. \cite{tsui02:_harmon_analy_using_neural_networ} and
\cite{buzzanca02:supervised} use back-propagating neural networks with
far better results. \cite{raphael03:harmonic} uses a hidden Markov
model for chordal analysis and tonal recognition.
\cite{noland.sandler:key} also uses a Hidden Markov model, but the
states represent possible keys and the inputs are the chord
changes. \cite{temperley04:bayesian} uses a bayesian model for key
recognition.

Probabilistic models, while not specifically addressing this problem,
differ from more deterministic ones in not specifically ignoring
harmonical context information, thus handling some cases slightly
better. On the other hand, due to their obliviousness to musical
theory, they are very sensitive on the training data, tending to
misbehave on slightly different scores.


\section{Segmentation}
% passos

The other crucial, though underrepresented in literature, problem in
the area of automated harmonic analysis is the division of a given
piece in harmonic significant segments before associating these
segments with chords and tonal functions. This problem is non-trivial,
since the number of possible partition points in a given piece is
proportional to the number of notes - usually divided by a constant
representing the number of voices and likelihood of chords and
double-steps - and, so, the number of possible segmentations is
approximately two to the power of the number of notes in a score.

The segmentation problem isn't clearly formalized in musical theory
texts, complicating the task of designing an effective algorithmical
solution for it. We believe that a more systematic approach to music
segmentation might wield considerably better results, since the
segmentation problem for harmonic analysis of tonal music is largely
unsolved. Due to its high computational complexity - the number of
possible partitions of a given piece being roughly proportional to two
to the power of the notes used - and its strict dependance on context,
efficient and comprehensive solutions for it are hard to find. Still,
it is of fundamental importance, for the rest of the analysis is
constrained by the existing segmentation.

\cite{prather96:harmonic} approaches the problem in a simplified
fashion, with chords being assumed to change only in the beats of a
given measure, and tonal information spread between two measures being
ignored. \cite{bod01:memory} proposes a memory-based model,
contrasting it with rule-based ones, with good results, although his
approach to segmentation in unrelated to harmonic analysis, and thus
not very relevant. \cite{barthelemy01:figured} uses melodic and
harmonic information to construct the segmentation bottom-up, i.e.
merging two adjacent segments if and only every sound of the first
belongs in the second and vice versa or if the union (with or without
ornamental notes) of both segments can be exactly mapped onto a
chord. The process starts with minimal segments and ends only when no
more merges can be performed. \cite{pardo02:algorithms} and
\cite{pardo99:automated} perform segmentation backwards, by comparing
all possible (or likely, in another version of the algorithm)
segmentations, choosing the ones that better match chord templates.

%%kroger: completar
Segmentation is also a problem in research dealing with audio formats.
\cite{abdallah.noland.ea:theory} divides the segmentation by timber,
harmony, and rhythm and pitch. ``they are not well adapted for use in
structure analysis from audio'' \cite{maddage04:content} combines
audio and symbolic representation for music structure analysis,
including chord detection.

\cite{neve.orio:experiments}

seção 3.1 de \cite{byrd02:problems}

\section{Harmonic Context}
% marcos

%% escrever: o que é contexto musical

The harmonic context is important in an automated harmonic analysis
system because some chords and notes (such as non-chord notes) only
can be correctly understood when it is considered. Proper use of
harmonic context helps solving problems such as ambiguities in chord
analysis, identification of non-chord notes and suspension and
ritardo of resolutions.

Some automated harmonic analysis systems consider harmonic context, as
the NUSO system \cite{mouton95:numeric}, that uses harmonic context to
define tonality through rules considering non-chord notes in
accompanied melody, Alberti bass and baroque style; the MusES system,
using relations between adjacent chords to define the best possible
tonality for a chord; and the automated harmonic analysis method
developed by \cite{barthelemy01:figured} that has a simple algorithm
to process non-chord notes, often producing errors. It considers that
every non-chord note is followed by a conjunct movement.  The authors
show problems related to ambiguities, non-regularity of harmonic
rhythm, non-universality of harmonic rules.

Other projects don't consider harmonic context, as
\cite{harte.sandler.ea:symbolic}, who says that in classical harmony
analysis the ``chords are notated in the context of a given key'', but
ignores key context in their model for chord labels; and
\cite{pardo99:automated} and \cite{pardo02:algorithms}, that developed
a set of algorithms for automated chordal analysis purposefully making
minimal use of harmonic context. The error frequencies are classified
and most of them are related to harmonic context, specifically
non-chord notes and cadence recognition. The authors agree that a
deeper understanding of voice leading and knowledge about neighbour
chords would help adjusting chord-label weights.

%% devo incluir isso?
% According to \cite{mouton95:numeric}, some works consider the harmonic
% context in automated harmonic analysis (c.f. ).

\nota{encaixar ou remover texto abaixo}

John Rothgeb foi um dos primeiros a lidar com o problema da
harmonização automática \cite{rothgeb68:harmonizing}, nesse caso o
problema do ``baixo não cifrado'' (i.e. uma técnica onde o
intrumentista harmoniza um baixo dado mas sem as cifras do baixo
cifrado). Ele implementou em computador regras de tratados do século
XVIII e logo ficou claro que os tratados não forneciam detalhes
completos o suficiente \cite{rothgeb79:simulating}.

\section{Tests and benchmarks}

Pardo states that ``no researchers have published statistical
performance results on a system designed to analyze tonal music''
\cite{pardo02:algorithms} before his paper. 

%%%%%%%%%
The lack of this sort of data in the literature makes dificult to
compare different systems.

This defficiency (deficiency) in the literature makescomparing
different systems difficult.
%%%%%%%%%%%%

Also, there is not a specific framework for comparison of different
algorithms and results. In fact, only Pardo \cite{pardo00:automated}
and Barthelemy \cite{barthelemy01:figured} published specific

%%%%%% 
comparisons between the result of theirs programs and the result of
the programs of other authors. Pardo compares his results with
\cite{temperley99:modeling} while Barthelemy compares his model

comparisons between their results other authors'. Pardo compares his
<what?> with \cite{temperley99:modeling} while Barthelemy measures his
model
%%%%%%%

against \cite{maxwell92:expert}, \cite{pardo99:automated} and
\cite{temperley96:algorithm}. This is the most comprehensive
comparision we know of. However, they are based on the results
published in papers and not on results from direct implementations,
which means that only the examples published by the authors can be
compared.

We believe in the importance of having standard tests to be performed
in a large corpus of music. Pickens \cite{pickens02:polyphonic} not
only agrees with that but uses a large corpus of music, consisting of
3150 pieces, in his own research.

\section{Conclusion and discussion}
\label{sec:concl-disc}

Although many aspects of music can be understood using mathematical
models such as the set theory (of post-tonal theory), it is not clear
in the literature if a mathematical approach could help in the problem
of harmonic analysis. Taneyev \cite{taneyev62:counterpoint} has used
mathematics extensively in his counterpoint treatise with a good
degree of success. As far as we know, there are not meaningful works
in the literature of automatic harmonic analysis where a mathematical
model such as the set theory is used extensively.

\nota{checar para ver se é 100\% verdade}

\cite{pardo02:algorithms} uses tuples as templates, with a numerical
representation of notes. All posible transpositions are defined as
templates, when could be much easier to calculate if two pitch class
sets are the same using the prime form. Maybe things like normal and
prime form, interval vector, index vector, and operations with super
and sub-sets can help identifying harmonic elements from the non-harmonic.

\nota{ver \cite{conklin95:multiple} em detalhe}

\nota{ver se cita \cite{conklin02:representation}}

\bibliographystyle{plain}
\bibliography{analise-harmonica,bib-geral,bib-outras,analise-harmonica-nao-tenho}
\end{document}
 
http://www.aaue.dk/~niklas/ICMC/?page_id=3

\section{Terminology}
% todos

% uma lista de possíveis termos a ser definidos, depois reduzir pra só
% os relevantes e definí-los
meter
pitch
segmentation
tonality
harmony
hidden markov model
melody
neural network
expert system
pattern matching
chord
greedy algorithm
island growing
ornamental note
music/harmonic context
Forma prima.
  Uma maneira de representar a classe de
  conjunto de uma maneira compacta e não-ambígua.
Vetor intervalar.
Uma representação compactada contendo
  todos os intervalos em um conjunto.
Número de classificação de Allen Forte.
Classificação
  usando dois dígitos proposta por Allen Forte para todas as classes
  de conjuntos. O primeiro dígito indica a quantidade de notas no
  conjunto e o segundo sua posição na lista de classes de conjuntos.
